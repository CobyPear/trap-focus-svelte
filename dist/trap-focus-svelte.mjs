function e(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}let t=[],n=!1;function o(o,r={active:!0}){var u,c;let{wrap:s=o,active:a}=r;const l=[...s.querySelectorAll("*")].filter(e=>e.tabIndex>=0),i=null!=(u=l.at(0))?u:s,f=null!=(c=l.at(-1))?c:s,d=document.activeElement;t.push(s),i.focus();const v=(e=s)=>t.at(-1).contains(e),m=e(i,"blur",()=>{a&&v()&&n&&f.focus()}),y=e(f,"blur",()=>{a&&v()&&!n&&i.focus()}),b=e(document,"focusin",e=>{a&&!v(e.target)&&(n?f:i).focus()});return{update(e){a=e.active},destroy(){b(),m(),y(),t=t.filter(e=>e!==s),d.focus()}}}e(document,"keydown",e=>{n=e.shiftKey&&"Tab"===e.key});export{o as trapFocus};
